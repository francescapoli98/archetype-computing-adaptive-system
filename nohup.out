  0%|          | 0/422 [00:00<?, ?it/s]  0%|          | 1/422 [00:00<02:34,  2.73it/s]  0%|          | 2/422 [00:00<02:31,  2.77it/s]  1%|          | 3/422 [00:00<02:01,  3.46it/s]  1%|          | 4/422 [00:01<01:47,  3.90it/s]  1%|          | 5/422 [00:01<01:36,  4.34it/s]  1%|▏         | 6/422 [00:01<01:31,  4.54it/s]  2%|▏         | 7/422 [00:01<01:33,  4.45it/s]  2%|▏         | 8/422 [00:01<01:31,  4.53it/s]  2%|▏         | 9/422 [00:02<01:27,  4.71it/s]  2%|▏         | 10/422 [00:02<01:24,  4.85it/s]  3%|▎         | 11/422 [00:02<01:22,  4.96it/s]  3%|▎         | 12/422 [00:02<01:23,  4.91it/s]  3%|▎         | 13/422 [00:02<01:23,  4.91it/s]  3%|▎         | 14/422 [00:03<01:20,  5.08it/s]  4%|▎         | 15/422 [00:03<01:19,  5.14it/s]  4%|▍         | 16/422 [00:03<01:18,  5.18it/s]  4%|▍         | 17/422 [00:03<01:17,  5.20it/s]  4%|▍         | 18/422 [00:03<01:17,  5.22it/s]  5%|▍         | 19/422 [00:04<01:16,  5.30it/s]  5%|▍         | 20/422 [00:04<01:15,  5.29it/s]  5%|▍         | 21/422 [00:04<01:16,  5.21it/s]  5%|▌         | 22/422 [00:04<01:15,  5.31it/s]  5%|▌         | 23/422 [00:04<01:17,  5.17it/s]  6%|▌         | 24/422 [00:05<01:17,  5.12it/s]  6%|▌         | 25/422 [00:05<01:16,  5.19it/s]  6%|▌         | 26/422 [00:05<01:16,  5.19it/s]  6%|▋         | 27/422 [00:05<01:16,  5.18it/s]  7%|▋         | 28/422 [00:05<01:15,  5.22it/s]  7%|▋         | 29/422 [00:06<01:15,  5.21it/s]  7%|▋         | 30/422 [00:06<01:15,  5.17it/s]  7%|▋         | 31/422 [00:06<01:14,  5.25it/s]  8%|▊         | 32/422 [00:06<01:15,  5.15it/s]  8%|▊         | 33/422 [00:06<01:14,  5.19it/s]  8%|▊         | 34/422 [00:06<01:14,  5.19it/s]  8%|▊         | 35/422 [00:07<01:15,  5.16it/s]  9%|▊         | 36/422 [00:07<01:14,  5.20it/s]  9%|▉         | 37/422 [00:07<01:14,  5.15it/s]  9%|▉         | 38/422 [00:07<01:15,  5.08it/s]  9%|▉         | 39/422 [00:07<01:14,  5.12it/s]  9%|▉         | 40/422 [00:08<01:14,  5.14it/s] 10%|▉         | 41/422 [00:08<01:12,  5.25it/s] 10%|▉         | 42/422 [00:08<01:12,  5.25it/s] 10%|█         | 43/422 [00:08<01:13,  5.13it/s] 10%|█         | 44/422 [00:08<01:13,  5.14it/s] 11%|█         | 45/422 [00:09<01:11,  5.26it/s] 11%|█         | 46/422 [00:09<01:11,  5.23it/s] 11%|█         | 47/422 [00:09<01:11,  5.26it/s] 11%|█▏        | 48/422 [00:09<01:11,  5.21it/s] 12%|█▏        | 49/422 [00:09<01:12,  5.17it/s] 12%|█▏        | 50/422 [00:10<01:18,  4.74it/s] 12%|█▏        | 51/422 [00:10<01:14,  4.95it/s] 12%|█▏        | 52/422 [00:10<01:14,  4.96it/s] 13%|█▎        | 53/422 [00:10<01:12,  5.07it/s] 13%|█▎        | 54/422 [00:10<01:12,  5.08it/s] 13%|█▎        | 55/422 [00:11<01:12,  5.03it/s] 13%|█▎        | 56/422 [00:11<01:11,  5.14it/s] 14%|█▎        | 57/422 [00:11<01:10,  5.17it/s] 14%|█▎        | 58/422 [00:11<01:10,  5.13it/s] 14%|█▍        | 59/422 [00:11<01:10,  5.16it/s] 14%|█▍        | 60/422 [00:12<01:09,  5.22it/s] 14%|█▍        | 61/422 [00:12<01:08,  5.30it/s] 15%|█▍        | 62/422 [00:12<01:08,  5.26it/s] 15%|█▍        | 63/422 [00:12<01:08,  5.24it/s] 15%|█▌        | 64/422 [00:12<01:12,  4.95it/s] 15%|█▌        | 65/422 [00:13<01:10,  5.04it/s] 16%|█▌        | 66/422 [00:13<01:11,  5.01it/s] 16%|█▌        | 67/422 [00:13<01:09,  5.09it/s] 16%|█▌        | 67/422 [00:13<01:11,  4.94it/s]
Traceback (most recent call last):
  File "/home/francescapoli/miniconda3/envs/myenv/lib/python3.9/runpy.py", line 197, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/home/francescapoli/miniconda3/envs/myenv/lib/python3.9/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/home/francescapoli/archetype-computing-adaptive-system/spiking_arch/smnist_fp.py", line 246, in <module>
    output, velocity, u, spk = model(images)
  File "/home/francescapoli/miniconda3/envs/myenv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/francescapoli/miniconda3/envs/myenv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/francescapoli/archetype-computing-adaptive-system/spiking_arch/s_ron.py", line 197, in forward
    hy, hz, u, spk = self.cell(x[:, t], hy, hz, u)
  File "/home/francescapoli/archetype-computing-adaptive-system/spiking_arch/s_ron.py", line 119, in cell
    spike, u = self.spiking_layer(x, hy, u) 
  File "/home/francescapoli/archetype-computing-adaptive-system/spiking_arch/s_ron.py", line 161, in spiking_layer
    u = u + (u_dot * (self.R*self.C))*self.dt # multiply to tau and dt
KeyboardInterrupt
  0%|          | 0/422 [00:00<?, ?it/s]  0%|          | 1/422 [00:00<02:37,  2.67it/s]  0%|          | 2/422 [00:00<02:35,  2.70it/s]  1%|          | 3/422 [00:00<02:00,  3.48it/s]  1%|          | 4/422 [00:01<01:45,  3.96it/s]  1%|          | 5/422 [00:01<01:35,  4.36it/s]  1%|▏         | 6/422 [00:01<01:29,  4.66it/s]  2%|▏         | 7/422 [00:01<01:32,  4.47it/s]  2%|▏         | 8/422 [00:01<01:28,  4.69it/s]  2%|▏         | 9/422 [00:02<01:24,  4.87it/s]  2%|▏         | 10/422 [00:02<01:21,  5.08it/s]  3%|▎         | 11/422 [00:02<01:20,  5.10it/s]  3%|▎         | 12/422 [00:02<01:19,  5.13it/s]  3%|▎         | 13/422 [00:02<01:19,  5.17it/s]  3%|▎         | 13/422 [00:02<01:31,  4.48it/s]
Traceback (most recent call last):
  File "/home/francescapoli/miniconda3/envs/myenv/lib/python3.9/runpy.py", line 197, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/home/francescapoli/miniconda3/envs/myenv/lib/python3.9/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/home/francescapoli/archetype-computing-adaptive-system/spiking_arch/smnist_fp.py", line 246, in <module>
    output, velocity, u, spk = model(images)
  File "/home/francescapoli/miniconda3/envs/myenv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/francescapoli/miniconda3/envs/myenv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/francescapoli/archetype-computing-adaptive-system/spiking_arch/s_ron.py", line 197, in forward
    hy, hz, u, spk = self.cell(x[:, t], hy, hz, u)
  File "/home/francescapoli/archetype-computing-adaptive-system/spiking_arch/s_ron.py", line 119, in cell
    spike, u = self.spiking_layer(x, hy, u) 
  File "/home/francescapoli/archetype-computing-adaptive-system/spiking_arch/s_ron.py", line 160, in spiking_layer
    u_dot = - u + (torch.matmul(hy, self.h2h) + torch.matmul(x, self.x2h)) # u dot (update) 
KeyboardInterrupt
